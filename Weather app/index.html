<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />

  <link rel="icon" href="devchallenges.png" />
  <link rel="shortcut icon" type="image/x-icon" href="https://devchallenges.io/" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <!-- <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/c2b7b2c34b.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="../normalize.css" type="text/css" />
  <link rel="stylesheet" href="style.css" type="text/css" />
  <style>
    ul {
      padding-left: 24px;
    }

    li {
      margin-bottom: 8px;
    }

    .welcome {
      max-width: 800px;
      margin: 0 auto;
    }

    .welcome-text {
      margin-top: 30vh;
      font-weight: 500;
    }

    .welcome-text p {
      font-size: 1rem;
      font-weight: 400;
    }

    .welcome-text h1 {
      font-size: 1.5rem;
    }

    .welcome-text a {
      color: #f7542e;
    }
  </style>

  <title>WeatherApp | Devchallenges</title>

  <style></style>
</head>

<body>
  <!-- <aside></aside> -->
  <main id="main-content">
    <article id="primary-content">
      <div id="primary-buttons">
        <button id="search-button" class="btn prm-btn">Search for places</button>
        <button id="gps-button" class="btn prm-btn">
          <i class="fa-solid fa-location-crosshairs"></i>
        </button>
      </div>
      <div id="primary-img">
        <img src="images/Shower.png" alt="shower weather" />
      </div>
      <div id="primary-infos">
        <p id="tempurature"><span id="tempurature-level">15</span><span id="celsius"><sup>o</sup>C</span></p>
        <p id="weather-state">Shower</p>
        <p id="date">Today . Fri, 5 Jun</p>
        <p id="location"><i class="fa-solid fa-location-dot"></i> Helsinki</p>
      </div>
    </article>

    <article id="secondary-content">
      <section id="wraper-solver">

        <section id="tempType" class="clearfix">
          <button class="btn btn-tempType">°C</button>
          <button class="btn btn-tempType">°F</button>
        </section>

        <section id="days">
        </section>

        <section class="highlights">
          <p>Today's Highlights</p>
          <div class="highlight-group">
            <div id="wind" class="highlight highlight-1">
              <p>Wind status</p>
              <p><span class="lf-span">7</span> <span class="mf-span">mph</span></p>
              <p><i class="fa-solid fa-location-arrow"></i> wsw</p>
            </div>
            <div id="humidity" class="highlight highlight-2">
              <p>Humidity</p>
              <p><span class="lf-span">84</span> <span class="mf-span">%</span></p>
              <div class="progress-bar__container">
                <p>
                <div class="progress-bar">
                  <span class="progress-bar__text"></span>
                </div>
                </p>
              </div>
            </div>
          </div>
          <div class="highlight-group">
            <div id="visibility" class="highlight">
              <p>Visibility</p>
              <p><span class="lf-span">6.4</span> <span class="mf-span">miles</span></p>
            </div>
            <div id="air" class="highlight">
              <p>Air Pressure</p>
              <p><span class="lf-span">998</span> <span class="mf-span">mb</span></p>
            </div>
          </div>
        </section>
      </section>


    </article>
  </main>

  <script>
    const element = document.getElementById("days");
    for (let index = 0; index < 1; index++) {
      const dayCard = document.createElement('div');
      dayCard.className = "day-card";
      dayCard.innerHTML = `
        <div class="day-date">Today</div>
        <div class="day-img">
            <img src="../images/Sleet.png" alt="Snow-day">
        </div>
        <div class="day-temp">
            <Span class="day-temp-max">16°C</span>
            &ensp;
            <Span class="day-temp-min">14°C</span>
        </div>`;
      element.appendChild(dayCard);
    }
  </script>

  <script>


    function getForecastData(forecastData, days = 5) {

      const daysData = {};
      let index = 0;

      const firstDayDate = new Date(forecastData[0].dt * 1000).getDate();
      let lastDate = firstDayDate

      for (let date of forecastData) {
        const currentDate = new Date(date.dt * 1000).getDate();

        if (currentDate > lastDate) {
          lastDate = currentDate;
          daysData[index] = date;
          index++;
        }

        // break when we have enough daysData
        if (currentDate > (firstDayDate + days)) {
          break;
        }
      }
      return daysData;
    }

    function weather(forecastData) {
      const element = document.getElementById("days");
      console.log('> weather ', forecastData);

      for (let key of Object.keys(forecastData)) {
        let date = new Date(forecastData[key].dt * 1000)
        console.log(forecastData[key]); // return (key value) pairs

        const dayCard = document.createElement('div');
        dayCard.className = "day-card";
        dayCard.innerHTML = `
        <div class="day-date">${date.getDay()}</div>
        <div class="day-img">
            <img src="../images/Sleet.png" alt="Snow-day">
        </div>
        <div class="day-temp">
            <Span class="day-temp-max">${forecastData[key].main.temp_max}°C</span>
            &ensp;
            <Span class="day-temp-min">${forecastData[key].main.temp_min}°C</span>
        </div>`;
        element.appendChild(dayCard);
      }

      // if (name) console.log(name);
      // if (weatherstate) console.log("   > weather state:", weatherstate);
      // if (maxTemp) console.log("   > max temp:", maxTemp);
      // if (minTemp) console.log("   > min temp:", minTemp);
      // if (date) console.log("   > Date:", date, typeof date);
    }

    const apiKey = "1882cccd3bc2868b511d2c16524c5e1b"; // Replace with your OpenWeatherMap API key
    const city = "New York"; // Replace with the desired city name

    fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        console.log(data);
        // Extract the forecast data for 5 days
        let forecastData = data.list;
        forecastData = getForecastData(forecastData, 5);
        console.log(forecastData);
        weather(forecastData);


        // // Display max and min temperature for today and the next 4 days
        // for (let i = 0; i < 5; i++) {
        //     weather(name, weatherstate, maxTemp, minTemp, forecastDate)
        //     const maxTemp = forecastData[i].main.temp_max;
        //     const minTemp = forecastData[i].main.temp_min;
        //     // weather('Day ' + (i + 1), null, maxTemp, minTemp, forecastData[i].dt);
        // }

        // Extract other weather data from the first forecast entry (current weather)
        const windSpeed = forecastData[0].wind.speed;
        const humidity = forecastData[0].main.humidity;
        const visibility = forecastData[0].visibility;
        const airPressure = forecastData[0].main.pressure;

        // Display wind speed, humidity, visibility, and air pressure
        console.log('Wind Speed:', windSpeed);
        console.log('Humidity:', humidity);
        console.log('Visibility:', visibility);
        console.log('Air Pressure:', airPressure);
      })
      .catch(error => {
        console.error("Error fetching weather data:", error);
      });



  </script>

  <!-- <i class="fa-solid fa-crosshairs"></i>
  <i class="fa-regular fa-crosshairs"></i>

  <i class="fa-solid fa-location-crosshairs"></i>
  <i class="fa-regular fa-location-crosshairs"></i>

  --- <i class="fa-solid fa-location-dot"></i> 

  <i class="fa-regular fa-location-dot"></i>
  <i class="fa-light fa-location-dot"></i> -->
</body>

</html>